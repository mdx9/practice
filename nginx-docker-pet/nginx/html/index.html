<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nginx DevOps Project —Å PostgreSQL</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h3 {
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #28a745;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .status-indicator.loading {
            background-color: #ffc107;
        }

        .status-indicator.error {
            background-color: #dc3545;
        }

        .api-section {
            margin: 20px 0;
        }

        .api-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-size: 14px;
            display: inline-block;
            text-decoration: none;
        }

        .api-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .api-button.primary {
            background: linear-gradient(45deg, #28a745, #20c997);
            border-color: #28a745;
        }

        .response-area {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .links {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .links a {
            color: #fff;
            text-decoration: none;
            padding: 15px 30px;
            background: linear-gradient(45deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .links a:hover {
            background: linear-gradient(45deg, rgba(255,255,255,0.3), rgba(255,255,255,0.2));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .stats-table th,
        .stats-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .stats-table th {
            background: rgba(255,255,255,0.1);
            font-weight: bold;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            color: #ff6b6b;
            background: rgba(255,107,107,0.1);
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ff6b6b;
        }

        .success-message {
            color: #51cf66;
            background: rgba(81,207,102,0.1);
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #51cf66;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üê≥ Nginx DevOps Project</h1>
            <p>Pet Project with PostgreSQL, Monitoring & Ansible</p>
            <p>–í—Ä–µ–º—è: <span id="currentTime"></span></p>
        </div>

        <div class="grid">
            <!-- –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã -->
            <div class="card">
                <h3>
                    <span class="status-indicator" id="systemStatus"></span>
                    –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
                </h3>
                <div id="systemInfo">
                    <p>üåê <strong>Nginx:</strong> <span id="nginxStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
                    <p>üîß <strong>API:</strong> <span id="apiStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
                    <p>üóÑÔ∏è <strong>PostgreSQL:</strong> <span id="dbStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
                    <p>üìä <strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:</strong> <span id="monitoringStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
                </div>
            </div>

            <!-- –†–∞–±–æ—Ç–∞ —Å –ë–î -->
            <div class="card">
                <h3>üóÑÔ∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è PostgreSQL</h3>
                <div class="api-section">
                    <button class="api-button primary" onclick="logVisit()">üìù –ó–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ</button>
                    <button class="api-button" onclick="getStats()">üìä –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                    <button class="api-button" onclick="checkDbHealth()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î</button>
                </div>
                <div id="dbResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π -->
            <div class="card">
                <h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π</h3>
                <div id="visitStats">
                    <p><strong>–í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π:</strong> <span id="totalVisits">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                    <p><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–∏–∑–∏—Ç—ã:</strong></p>
                    <div id="recentVisits">–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</div>
                </div>
                <button class="api-button" onclick="refreshStats()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
            </div>

            <!-- API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
            <div class="card">
                <h3>üîß API Endpoints</h3>
                <div class="api-section">
                    <button class="api-button" onclick="testEndpoint('/api/health')">Health Check</button>
                    <button class="api-button" onclick="testEndpoint('/api/stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    <button class="api-button" onclick="testEndpoint('/health')">Nginx Health</button>
                    <button class="api-button" onclick="testEndpoint('/status')">Nginx Status</button>
                </div>
                <div id="apiResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ -->
            <div class="card">
                <h3>üìö –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞</h3>
                <ul style="text-align: left; line-height: 1.8;">
                    <li><strong>Nginx:</strong> Reverse proxy + —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã</li>
                    <li><strong>Flask API:</strong> Backend –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î</li>
                    <li><strong>PostgreSQL:</strong> –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                    <li><strong>Prometheus:</strong> –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫</li>
                    <li><strong>Grafana:</strong> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</li>
                    <li><strong>Ansible:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è</li>
                    <li><strong>Docker:</strong> –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤</li>
                </ul>
            </div>

            <!-- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ -->
            <div class="card">
                <h3>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h3>
                <div id="metricsInfo">
                    <p>üîÑ <strong>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong> <span id="activeConnections">‚Äî</span></p>
                    <p>üìà <strong>–ó–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</strong> <span id="totalRequests">‚Äî</span></p>
                    <p>‚è±Ô∏è <strong>Uptime:</strong> <span id="uptime">‚Äî</span></p>
                </div>
                <button class="api-button" onclick="refreshMetrics()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏</button>
            </div>
        </div>

        <div class="links">
            <a href="/health" target="_blank">
                <span>‚úÖ</span> Health Check
            </a>
            <a href="/status" target="_blank">
                <span>üìä</span> Nginx Status
            </a>
            <a href="http://localhost:3000" target="_blank">
                <span>üìà</span> Grafana
            </a>
            <a href="http://localhost:9090" target="_blank">
                <span>üéØ</span> Prometheus
            </a>
            <a href="http://localhost:5000/api/health" target="_blank">
                <span>üîß</span> API Health
            </a>
        </div>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateTime() {
            document.getElementById('currentTime').textContent = new Date().toLocaleString('ru-RU');
        }
        setInterval(updateTime, 1000);
        updateTime();

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            checkSystemStatus();
            refreshStats();
            refreshMetrics();
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–µ—â–µ–Ω–∏—è
        async function logVisit() {
            const responseDiv = document.getElementById('dbResponse');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = '<div class="loading"></div> –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–æ—Å–µ—â–µ–Ω–∏–µ...';

            try {
                const response = await fetch('/api/visit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    responseDiv.innerHTML = `<div class="success-message">‚úÖ –ü–æ—Å–µ—â–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ!<br>–í—Ä–µ–º—è: ${data.timestamp}</div>`;
                    setTimeout(() => refreshStats(), 1000); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
                } else {
                    responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function getStats() {
            const responseDiv = document.getElementById('dbResponse');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = '<div class="loading"></div> –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...';

            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                if (response.ok) {
                    let html = `<div class="success-message">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</div>`;
                    html += `<p><strong>–í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π:</strong> ${data.total_visits}</p>`;
                    
                    if (data.recent_visits && data.recent_visits.length > 0) {
                        html += `<p><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–∏–∑–∏—Ç—ã:</strong></p>`;
                        html += `<table class="stats-table"><tr><th>IP</th><th>–í—Ä–µ–º—è</th><th>User Agent</th></tr>`;
                        data.recent_visits.slice(0, 5).forEach(visit => {
                            const date = new Date(visit.visit_time).toLocaleString('ru-RU');
                            const userAgent = visit.user_agent ? visit.user_agent.substring(0, 30) + '...' : 'Unknown';
                            html += `<tr><td>${visit.ip_address}</td><td>${date}</td><td>${userAgent}</td></tr>`;
                        });
                        html += `</table>`;
                    }
                    
                    responseDiv.innerHTML = html;
                } else {
                    responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –ë–î
        async function checkDbHealth() {
            const responseDiv = document.getElementById('dbResponse');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = '<div class="loading"></div> –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î...';

            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                
                if (response.ok) {
                    let statusClass = data.status === 'healthy' ? 'success-message' : 'error-message';
                    let statusIcon = data.status === 'healthy' ? '‚úÖ' : '‚ùå';
                    
                    responseDiv.innerHTML = `
                        <div class="${statusClass}">
                            ${statusIcon} API Status: ${data.status}<br>
                            üóÑÔ∏è Database: ${data.database}<br>
                            ‚è∞ Timestamp: ${new Date(data.timestamp).toLocaleString('ru-RU')}
                        </div>
                    `;
                } else {
                    responseDiv.innerHTML = `<div class="error-message">‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>`;
                }
            } catch (error) {
                responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è endpoints
        async function testEndpoint(endpoint) {
            const responseDiv = document.getElementById('apiResponse');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = `<div class="loading"></div> –¢–µ—Å—Ç–∏—Ä—É–µ–º ${endpoint}...`;

            try {
                const response = await fetch(endpoint);
                const contentType = response.headers.get('content-type');
                
                let data;
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                    data = JSON.stringify(data, null, 2);
                } else {
                    data = await response.text();
                }
                
                const statusClass = response.ok ? 'success-message' : 'error-message';
                const statusIcon = response.ok ? '‚úÖ' : '‚ùå';
                
                responseDiv.innerHTML = `
                    <div class="${statusClass}">
                        ${statusIcon} ${endpoint} - Status: ${response.status}
                    </div>
                    <pre style="white-space: pre-wrap; margin-top: 10px;">${data}</pre>
                `;
            } catch (error) {
                responseDiv.innerHTML = `<div class="error-message">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å–µ—â–µ–Ω–∏–π
        async function refreshStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                document.getElementById('totalVisits').textContent = data.total_visits || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
                
                const recentVisitsDiv = document.getElementById('recentVisits');
                if (data.recent_visits && data.recent_visits.length > 0) {
                    let html = '<table class="stats-table" style="font-size: 11px;"><tr><th>IP</th><th>–í—Ä–µ–º—è</th></tr>';
                    data.recent_visits.slice(0, 3).forEach(visit => {
                        const date = new Date(visit.visit_time).toLocaleString('ru-RU');
                        html += `<tr><td>${visit.ip_address}</td><td>${date}</td></tr>`;
                    });
                    html += '</table>';
                    recentVisitsDiv.innerHTML = html;
                } else {
                    recentVisitsDiv.innerHTML = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö';
                }
            } catch (error) {
                document.getElementById('totalVisits').textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                document.getElementById('recentVisits').innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
        async function checkSystemStatus() {
            const statusIndicator = document.getElementById('systemStatus');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
            try {
                const nginxResponse = await fetch('/health');
                document.getElementById('nginxStatus').textContent = nginxResponse.ok ? '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
            } catch {
                document.getElementById('nginxStatus').textContent = '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ API
            try {
                const apiResponse = await fetch('/api/health');
                const apiData = await apiResponse.json();
                document.getElementById('apiStatus').textContent = apiResponse.ok ? '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                document.getElementById('dbStatus').textContent = 
                    apiData.database === 'connected' ? '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞';
            } catch {
                document.getElementById('apiStatus').textContent = '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                document.getElementById('dbStatus').textContent = '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
            try {
                const prometheusResponse = await fetch('http://localhost:9090/api/v1/status/config');
                document.getElementById('monitoringStatus').textContent = 
                    prometheusResponse.ok ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                statusIndicator.className = 'status-indicator';
            } catch {
                document.getElementById('monitoringStatus').textContent = '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                statusIndicator.className = 'status-indicator error';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
        async function refreshMetrics() {
            try {
                const response = await fetch('/status');
                const text = await response.text();
                
                // –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ nginx
                const activeMatch = text.match(/Active connections:\s*(\d+)/);
                const requestsMatch = text.match(/(\d+)\s+(\d+)\s+(\d+)/);
                
                if (activeMatch) {
                    document.getElementById('activeConnections').textContent = activeMatch[1];
                }
                
                if (requestsMatch) {
                    document.getElementById('totalRequests').textContent = requestsMatch[3];
                }
                
                // –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (–ø—Ä–∏–º–µ—Ä–Ω–æ–µ)
                const uptime = Math.floor(Date.now() / 1000 / 60); // –º–∏–Ω—É—Ç—ã —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
                document.getElementById('uptime').textContent = `${uptime} –º–∏–Ω`;
                
            } catch (error) {
                document.getElementById('activeConnections').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('totalRequests').textContent = '–û—à–∏–±–∫–∞';
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            refreshStats();
            refreshMetrics();
        }, 30000);

        // –õ–æ–≥–∏—Ä—É–µ–º –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            setTimeout(logVisit, 2000); // –õ–æ–≥–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        });
    </script>
</body>
</html>
